{% load static %}
<link rel="stylesheet" href="{% static 'css/tasks.css' %}?v=2.0">

<div class="modal fade" id="taskDetailModal" tabindex="-1" aria-labelledby="taskDetailModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <div class="d-flex align-items-center justify-content-between w-100">
          <div class="modal-top-info">
            <h3 class="modal-title" id="taskDetailModalLabel">Task Details</h3>
            <div>
              <span class="task-id">Task #{{ task.task_id }}</span>
              {% if task.team_ID %}
                <span class="team-id">Team {{ task.team_ID }}</span>
              {% else %}
                <span class="team-id text-muted" style="font-style: italic;">No team assigned</span>
              {% endif %}
            </div>
          </div>
        </div>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>

      <div class="modal-body">
        {% if not task %}
          <p class="text-danger">Task not found.</p>
        {% else %}
        <div class="row">
          <div class="col-md-7 border-end pe-4">
            <div class="mb-3">
              <label class="form-label">Task Name</label>
              <p class="form-control-plaintext">{{ task.title|default:'(No title)' }}</p>
            </div>

            <div class="mb-3">
              <label class="form-label">Status</label>
              <p class="form-control-plaintext">
                <span class="badge 
                  {% if task.status == 'Completed' %}bg-success
                  {% elif task.status == 'In Progress' %}bg-warning
                  {% else %}bg-secondary{% endif %}">
                  {{ task.status|default:'Pending' }}
                </span>
              </p>
            </div>

            <div class="mb-3">
              <label class="form-label">Description</label>
              <p class="form-control-plaintext">{{ task.description|default:'(No description)' }}</p>
            </div>

            <div class="row">
              <div class="col-md-6">
                <div class="mb-3">
                  <label class="form-label">Created By</label>
                  <p class="form-control-plaintext">{{ task.created_by|default:'(Unknown)' }}</p>
                </div>
              </div>
              <div class="col-md-6">
                <div class="mb-3">
                  <label class="form-label">Created Date</label>
                  <p class="form-control-plaintext">{{ task.date_created|slice:":10"|default:'Unknown' }}</p>
                </div>
              </div>
            </div>
          </div>

          <div class="col-md-5 ps-4">
            <div class="mb-3">
              <label class="form-label">Assigned To</label>
              <p class="form-control-plaintext">
                {% if task.assigned_user %}
                  {{ task.assigned_user.username|default:'(Unassigned)' }}
                {% else %}
                  <span class="text-muted">(Unassigned)</span>
                {% endif %}
              </p>
            </div>

            <div class="mb-3">
              <label class="form-label">Priority</label>
              <p class="form-control-plaintext">
                {% if task.priority %}
                  <span class="badge bg-danger">High Priority</span>
                {% else %}
                  <span class="badge bg-secondary">Normal</span>
                {% endif %}
              </p>
            </div>

            <div class="mb-3">
              <label class="form-label">Completion</label>
              <div class="progress">
                <div class="progress-bar" role="progressbar" 
                     style="width: {{ task.completion|default:0 }}%">
                  {{ task.completion|default:0 }}%
                </div>
              </div>
            </div>

            <div class="mb-3">
              <label class="form-label">Start Date</label>
              <p class="form-control-plaintext">{{ task.start_date|default:'Not set' }}</p>
            </div>

            <div class="mb-3">
              <label class="form-label">Due Date</label>
              <p class="form-control-plaintext">{{ task.due_date|default:'Not set' }}</p>
            </div>
          </div>
        </div>
        {% endif %}
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
