{% extends "base.html" %}

{% block title %}Event Details: {{ event.title }}{% endblock %}

{% block content %}
<div class="event-detail-container">
    <div class="page-header">
        <div class="header-left">
            <h1><i class="fas fa-calendar-alt me-2"></i>Event Details</h1>
            <p class="text-muted">View event information</p>
        </div>
        <div class="header-right">
            <div class="btn-group">
                <a href="{% url 'admin_app_collabsphere:event_edit' event.event_id %}" class="btn btn-warning">
                    <i class="fas fa-edit me-1"></i> Edit
                </a>
                <button class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#deleteEventModal">
                    <i class="fas fa-trash me-1"></i> Delete
                </button>
                <a href="{% url 'admin_app_collabsphere:event_management' %}" class="btn btn-secondary">
                    <i class="fas fa-arrow-left me-1"></i> Back
                </a>
            </div>
        </div>
    </div>

    <div class="card mb-4">
        <div class="card-body">
            <h3 class="card-title">{{ event.title }}</h3>
            
            <div class="row mt-4">
                <div class="col-md-8">
                    <div class="mb-4">
                        <label class="text-muted small">Description</label>
                        <p class="mb-0">{{ event.description|default:"No description"|linebreaks }}</p>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="text-muted small">Event ID</label>
                                <p class="mb-0">{{ event.event_id }}</p>
                            </div>
                            
                            <div class="mb-3">
                                <label class="text-muted small">Start Time</label>
                                <p class="mb-0">
                                    <i class="fas fa-calendar me-1"></i>
                                    {{ event.start_time|date:"F d, Y" }}
                                    <br>
                                    <i class="fas fa-clock me-1"></i>
                                    {{ event.start_time|time:"g:i A" }}
                                </p>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="text-muted small">Duration</label>
                                <p class="mb-0">
                                    {% if event.start_time and event.end_time %}
                                        {% with duration=event.end_time|timeuntil:event.start_time %}
                                            {{ duration }}
                                        {% endwith %}
                                    {% else %}
                                        Not specified
                                    {% endif %}
                                </p>
                            </div>
                            
                            <div class="mb-3">
                                <label class="text-muted small">End Time</label>
                                <p class="mb-0">
                                    <i class="fas fa-calendar me-1"></i>
                                    {{ event.end_time|date:"F d, Y" }}
                                    <br>
                                    <i class="fas fa-clock me-1"></i>
                                    {{ event.end_time|time:"g:i A" }}
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-4">
                    <div class="card">
                        <div class="card-header">
                            <h6 class="card-title mb-0">Event Information</h6>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <label class="text-muted small">Organizer</label>
                                <p class="mb-0">
                                    {% if event.user and event.user.username %}
                                        {{ event.user.username }}
                                    {% else %}
                                        Not assigned
                                    {% endif %}
                                </p>
                            </div>
                            
                            <div class="mb-3">
                                <label class="text-muted small">Team</label>
                                <p class="mb-0">
                                    {% if event.team_ID %}
                                        Team ID: {{ event.team_ID }}
                                    {% else %}
                                        No team
                                    {% endif %}
                                </p>
                            </div>
                            
                            <div class="mb-3">
                                <label class="text-muted small">Created</label>
                                <p class="mb-0">
                                    {% if event.created_at %}
                                        {{ event.created_at|slice:":10" }}
                                    {% else %}
                                        Unknown
                                    {% endif %}
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Delete Confirmation Modal -->
<div class="modal fade" id="deleteEventModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Confirm Deletion</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete event <strong>"{{ event.title }}"</strong>?</p>
                <p class="text-danger">
                    <small>This action cannot be undone. All event data will be permanently removed.</small>
                </p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <form method="POST" action="{% url 'admin_app_collabsphere:delete_event' event.event_id %}">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-danger">Delete Event</button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}